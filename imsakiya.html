<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أوقات الإمساك والإفطار - تونس</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
            direction: rtl;
            font-family: Arial, sans-serif;
        }

        .widget-container {
            width: 300px;
            height: 250px;
            overflow: hidden;
            border: 2px solid #ddd;
            border-radius: 10px;
            background-color: #f8f9fa;
            position: relative;
            padding: 10px;
            display: flex;
            flex-direction: column;
        }

        .ticker-title {
          font-family:Cairo;
            font-weight: bold;
            text-align: center;
            color: blue;
            padding: 5px 0;
            background-color: #fff;
            border-bottom: 2px solid #ddd;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .ticker-container {
          font-family:Cairo;
            flex-grow: 1;
            overflow: hidden;
            position: relative;
        }

        .ticker-list {
            list-style: none;
            padding: 0;
            margin: 0;
            position: absolute;
            width: 100%;
        }

        .ticker-item {
            padding: 8px;
            text-align: center;
            background-color: #fff;
            margin-bottom: 5px;
            border-radius: 5px;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-light">
    <div class="container my-3 d-flex justify-content-center">
        <div class="widget-container" id="widget">
            <h6 class="ticker-title">📢 أوقات الإمساك والإفطار اليوم</h6>
          <h6 id='date' align='center'></h6> <h6 id='date2' align='center'></h6>
            <div class="ticker-container">
                <ul class="ticker-list" id="timesTicker">
                    <li class="ticker-item">جارٍ تحميل الأوقات...</li>
                </ul>
            </div>
        </div>
    </div>

    <script >
   function showDate() {
            const now = new Date();
            
            const formattedDate = now.toLocaleString('ar-TN',{ year: 'numeric', month: 'long', day:'numeric',weekday: 'long'}); // Formats based on the user's locale
           
            document.getElementById("date").innerText = formattedDate;
            
        }

        showDate();
        
       function showDate2() {
            const now = new Date();
            
            const formattedDate = now.toLocaleString('ar-TN-u-ca-islamic',{ year: 'numeric', month: 'long', day:'numeric',weekday: 'long'}); // Formats based on the user's locale
           
            document.getElementById("date2").innerText = formattedDate;
            
        }

        showDate2();

// قائمة الولايات التونسية
const governorates = [
    "تونس", "أريانة", "بن عروس", "منوبة", "بنزرت", "نابل", "زغوان",
    "سوسة", "المنستير", "المهدية", "صفاقس", "القيروان", "القصرين", "سيدي بوزيد",
    "قفصة", "توزر", "قبلي", "مدنين", "تطاوين", "الكاف", "سليانة", "جندوبة"
];

let tickerInterval;

// دالة لاختيار لون عشوائي
function getRandomColor() {
    const colors = ["#e6194b", "#3cb44b", "#ffe119", "#4363d8", "#f58231", "#911eb4", "#46f0f0", "#f032e6", "#bcf60c", "#fabebe"];
    return colors[Math.floor(Math.random() * colors.length)];
}

// جلب أوقات الصلاة دفعة واحدة
async function fetchAllPrayerTimes() {
    const requests = governorates.map(city =>
        fetch(`https://api.aladhan.com/v1/timingsByCity?city=${city}&country=Tunisia&method=18`)
            .then(response => response.json())
            .then(data => ({
                city,
                imsak: data.data.timings.Imsak,
                maghrib: data.data.timings.Maghrib
            }))
            .catch(error => {
                console.error(`خطأ في جلب البيانات لـ ${city}:`, error);
                return { city, imsak: "00:00", maghrib: "00:00" };
            })
    );

    return Promise.all(requests);
}

// تحديث الشريط بالأوقات
async function updateTicker() {
    const prayerTimes = await fetchAllPrayerTimes();

    const tickerList = document.getElementById("timesTicker");
    tickerList.innerHTML = ""; // تفريغ القائمة قبل التحديث

    prayerTimes.forEach(({ city, imsak, maghrib }) => {
        const listItem = document.createElement("li");
        listItem.className = "ticker-item";
        const cityColor = getRandomColor(); // تحديد لون عشوائي للمدينة
        listItem.innerHTML = `🌙 <span style="color:${cityColor}; font-weight:bold; font-family:Cairo;">${city}</span>: إمساك ${imsak} - إفطار ${maghrib}`;
        tickerList.appendChild(listItem);
    });

    startTickerAnimation();
}

// حركة الشريط من الأسفل إلى الأعلى
function startTickerAnimation() {
    const tickerList = document.getElementById("timesTicker");
    let scrollAmount = 0;
    const itemHeight = document.querySelector(".ticker-item").offsetHeight;
    const totalHeight = tickerList.scrollHeight;

    function scrollUp() {
        if (scrollAmount >= totalHeight - itemHeight) {
            scrollAmount = 0;
            tickerList.style.transition = "none"; // إعادة التعيين بدون حركة مفاجئة
            tickerList.style.transform = `translateY(0px)`;
        } else {
            scrollAmount += itemHeight;
            tickerList.style.transition = "transform 0.5s ease-in-out";
            tickerList.style.transform = `translateY(-${scrollAmount}px)`;
        }
    }

    clearInterval(tickerInterval);
    tickerInterval = setInterval(scrollUp, 2000);
}

// ⏸️ إيقاف الحركة عند لمس الماوس أو الشاشة
const widget = document.getElementById("widget");
widget.addEventListener("mouseenter", () => clearInterval(tickerInterval));
widget.addEventListener("mouseleave", startTickerAnimation);
widget.addEventListener("touchstart", () => clearInterval(tickerInterval));
widget.addEventListener("touchend", startTickerAnimation);

// تشغيل الوظيفة عند تحميل الصفحة
updateTicker();

  
  </script>
</body>
</html>

